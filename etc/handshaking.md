# TCP 3-way-handshaking (TCP 연결설정)
정상적인 TCP 연결을 수립하려면 3가지 단계가 필요하다.
> 1. 최초의 호스트가 두번째 호스트에 SYN(동기화) 메세지를 보낸다. 이 메세지에는 자체 시퀀스번호 x 가 있으며 이것을 두번째 호스트가 받는다.
> 2. 두번째 호스트는 SYN-ACK 메세지와 함께 응답한다. 이 메세지는 자체 시퀀스 번호 y 와 응답 번호 x + 1 을 포함하며 첫번째 호스트가 응답을 받는다.
> 3. 첫번쨰 호스트는 응답 메세지와 함께 응답한다. 이 메세지는 응답 번호 y + 1 을 포함하고 있으며 두번째 호스트가 응답을 받지만 이미 연결보장이 되었으므로 이에 재응답 할 필요는 없다.
# TCP 4-way-handshaking (TCP 연결종료)
정상적으로 연결설정이 완료되어 데이터 송수신이 이루어졌다면 연결종료 과정을 거친 후 연결이 종료되게 된다.
> 1.먼저 close()를 실행한 클라이언트가 FIN을 보내고 FIN_WAIT1 상태로 대기한다.
> 2.서버는 CLOSE_WAIT으로 바꾸고 응답 ACK를 전달한다. 그와 동시에 해당 포트에 연결되어 있는 어플리케이션에게 close()를 요청한다.
> 3.ACK를 받은 클라이언트는 상태를 FIN_WAIT2로 변경한다.
> 4. close() 요청을 받은 서버 어플리케이션은 종료 프로세스를 진행하고 FIN을 클라이언트에 보내 LAST_ACK 상태로 바꾼다.
> 5.FIN을 받은 클라이언트는 ACK를 서버에 다시 전송하고 TIME_WAIT으로 상태를 바꾼다. TIME_WAIT에서 일정 시간이 지나면 CLOSED된다. ACK를 받은 서버도 포트를 CLOSED로 닫는다.

![TCP 통신과정](../image/tcp_ladder_states.png)